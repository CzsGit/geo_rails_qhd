function initMap(e,n,t,o,a){try{if(null==map){map=new BMap.Map(e,{minZoom:o,maxZoom:a}),map.addControl(new BMap.NavigationControl),map.addControl(new BMap.ScaleControl),map.addControl(new BMap.OverviewMapControl),map.enableScrollWheelZoom(!0),map.addControl(new BMap.MapTypeControl),myGeo=new BMap.Geocoder}"\u4e2d\u56fd"==n?map.centerAndZoom(n,5):(null==t&&(t=11),map.centerAndZoom(n,t))}catch(i){map=null}}function showMapText(e){var n,t,o,a,i;map.clearOverlays();for(var r=0;r<e.length;r++){n=e[r].aqi,t=e[r].latitude,o=e[r].longitude,a=new BMap.Point(o,t),level=getLevel(n),color=level.color,quality=level.quality;var l={position:a,offset:new BMap.Size(-15,-10)},i=new BMap.Label(n,l);i.setStyle({color:"white",background:color,fontSize:"12px",border:"",width:"30px",textAlign:"center",height:"20px",lineHeight:"20px",fontFamily:"\u5fae\u8f6f\u96c5\u9ed1"}),map.addOverlay(i)}}function showMap(e,n,t,o,a,i,r,l,p){if("\u4e2d\u56fd"!=i&&(t=i+t),null!=n&&null!=t){var c={onSearchComplete:function(e){if(u.getStatus()==BMAP_STATUS_SUCCESS){var t=e.getPoi(0).point;addPoint(n,t,o,a,r,l,p)}}},u=new BMap.LocalSearch(e,c);u.search(t)}}function addPoint(e,n,t,o,a,i,r){var l=new BMap.Icon(a,new BMap.Size(23,32)),p=new BMap.Marker(n,{icon:l}),c=new BMap.Label(e),u=(e.length,new BMap.Size(25,5));c.setOffset(u),i&&p.setLabel(c),p.setTitle(t),map.addOverlay(p);new BMap.InfoWindow(o);1==r&&p.addEventListener("mouseover",function(){var e={width:385,height:270,title:"",enableMessage:!1,message:""},t=new BMap.InfoWindow(o,e);map.openInfoWindow(t,n)})}function addPointWithLabel(e,n,t,o,a,i,r,l){color=getColorByIndex(i);var p={position:n,offset:new BMap.Size(-15,-10)},c=new BMap.Label(a,p);c.setStyle({color:"white",background:color,fontSize:"13px",border:"",width:"32px",textAlign:"center",height:"20px",lineHeight:"20px"}),c.setTitle(t),map.addOverlay(c),1==l&&c.addEventListener("mouseover",function(){var t=new BMapLib.SearchInfoWindow(map,o,{title:'<sapn style="font-size:14px">'+e+"</span>",width:315,height:115,enableAutoPan:!0});t.open(n)})}function getLevelIndex(e){var n;return 200>=e?(n=Math.ceil(e/50),0>n&&(n=1)):n=300>e?5:6,n}function getIcon(e){var n=null;return n=0>=e?"resource/img/map/00.png":50>=e?"resource/img/map/01.png":100>=e?"resource/img/map/02.png":150>=e?"resource/img/map/03.png":200>=e?"resource/img/map/04.png":300>=e?"resource/img/map/05.png":"resource/img/map/06.png"}function getMap(){var e=new Object;return e.put=function(n,t){e[n+"_"]=t},e.get=function(n){return e[n+"_"]},e.remove=function(n){delete e[n+"_"]},e.keyset=function(){var n="";for(var t in e)"string"==typeof t&&"_"==t.substring(t.length-1)&&(n+=",",n+=t.substring(0,t.length-1));return""==n?n.split(","):n.substring(1).split(",")},e}var map=null,myGeo=null;